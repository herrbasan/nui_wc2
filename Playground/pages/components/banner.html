<header>
	<h1>Banner Component</h1>
	<p>Edge-anchored notification banners for passive, informational messages</p>
</header>

<section>
	<h2>Overview</h2>
	<p>The <code>&lt;nui-banner&gt;</code> component provides notification banners that anchor to the top or bottom edge of their container. Banners are designed for passive notifications that don't require immediate user action‚Äîuse dialogs for interactions that need user response.</p>
	<p><strong>Key features:</strong></p>
	<ul>
		<li>Placement at top or bottom edge</li>
		<li>Optional auto-close with configurable timeout</li>
		<li>Priority levels for accessibility (info/alert)</li>
		<li>Slide animations</li>
		<li>Singleton per placement (factory-created banners)</li>
	</ul>
</section>

<section>
	<h2>Declarative Banners</h2>
	<p>Define banners in HTML using the <code>&lt;nui-banner&gt;</code> element. Control visibility with the <code>.show()</code> and <code>.close()</code> methods, or use declarative actions.</p>
	<nui-code>
		<pre><code data-lang="html">&lt;nui-banner id="my-banner" placement="bottom" auto-close="5000"&gt;
    &lt;div style="padding: 1rem;"&gt;
        &lt;span&gt;This is a declarative banner.&lt;/span&gt;
        &lt;!-- CSP-safe close action --&gt;
        &lt;button data-action="banner-close:dismiss@#my-banner"&gt;
            Dismiss
        &lt;/button&gt;
    &lt;/div&gt;
&lt;/nui-banner&gt;

&lt;!-- Trigger button --&gt;
&lt;button data-action="banner-show@#my-banner"&gt;Show Banner&lt;/button&gt;

&lt;script&gt;
// Generic handler for banner actions
document.addEventListener('nui-action', (e) => {
    const { name, target, param } = e.detail;
    if (name === 'banner-show') target.show();
    if (name === 'banner-close') target.close(param);
});
&lt;/script&gt;</code></pre>
	</nui-code>
	<h3>Try It</h3>
	<nui-button-container gap="1rem">
		<nui-button><button type="button" data-action="banner-show@#demo-banner">Show Banner</button></nui-button>
		<nui-button><button type="button" data-action="banner-close@#demo-banner">Close Banner</button></nui-button>
	</nui-button-container>

	<nui-banner id="demo-banner" placement="bottom" auto-close="5000">
		<div style="padding: 1rem; display: flex; justify-content: space-between; align-items: center;">
			<span>This is a declarative banner with 5 second auto-close.</span>
			<button type="button" data-action="banner-close:dismiss@#demo-banner">Dismiss</button>
		</div>
	</nui-banner>
</section>

<section>
	<h2>Programmatic Banners (Factory)</h2>
	<p>Use <code>nui.components.banner.show()</code> to create banners programmatically. This is the recommended approach for dynamic notifications.</p>
	<nui-code>
		<pre><code data-lang="javascript">// Basic banner with auto-close
nui.components.banner.show({
    content: 'Your changes have been saved.',
    placement: 'bottom',  // 'top' or 'bottom'
    autoClose: 3000       // milliseconds (0 = no auto-close)
});

// Banner with priority for accessibility
nui.components.banner.show({
    content: 'Connection lost. Retrying...',
    placement: 'top',
    priority: 'alert',    // 'info' (default) or 'alert'
    autoClose: 0
});</code></pre>
	</nui-code>
	<h3>Try It</h3>
	<nui-button-container gap="1rem">
		<nui-button><button type="button" data-action="show-top-banner">Top Banner</button></nui-button>
		<nui-button><button type="button" data-action="show-bottom-banner">Bottom Banner</button></nui-button>
		<nui-button><button type="button" data-action="show-persistent-banner">Persistent (No Auto-Close)</button></nui-button>
	</nui-button-container>
</section>

<section>
	<h2>Factory Return Value</h2>
	<p>The factory returns a controller object for programmatic control:</p>
	<nui-code>
		<pre><code data-lang="javascript">const banner = nui.components.banner.show({
    content: 'Processing...',
    placement: 'bottom',
    autoClose: 0
});

// Controller properties and methods:
banner.element   // The nui-banner DOM element
banner.close()   // Close the banner (with optional action string)
banner.update()  // Update banner content
banner.onClose() // Register close callback

// Example: Update and close programmatically
banner.update('Complete!');
setTimeout(() => banner.close('done'), 2000);

// Example: Handle close action
banner.onClose((action) => {
    console.log('Banner closed with action:', action);
});</code></pre>
	</nui-code>
</section>

<section>
	<h2>Priority Levels &amp; Accessibility</h2>
	<p>Banners support two priority levels that affect ARIA attributes:</p>
	<nui-table>
		<table>
			<thead>
				<tr>
					<th>Priority</th>
					<th>ARIA Role</th>
					<th>Behavior</th>
				</tr>
			</thead>
			<tbody>
				<tr>
					<td><code>info</code> (default)</td>
					<td><code>role="status"</code></td>
					<td>Politely announced when screen reader is idle</td>
				</tr>
				<tr>
					<td><code>alert</code></td>
					<td><code>role="alert"</code></td>
					<td>Immediately announced, interrupts current speech</td>
				</tr>
			</tbody>
		</table>
	</nui-table>
	<nui-code>
		<pre><code data-lang="javascript">// Info: Non-urgent status updates
nui.components.banner.show({
    content: 'Auto-saved.',
    priority: 'info'
});

// Alert: Important notifications requiring attention
nui.components.banner.show({
    content: 'Session expires in 5 minutes!',
    priority: 'alert'
});</code></pre>
	</nui-code>
	<h3>Try It</h3>
	<nui-button-container gap="1rem">
		<nui-button><button type="button" data-action="show-info-banner">Info Priority</button></nui-button>
		<nui-button><button type="button" data-action="show-alert-banner">Alert Priority</button></nui-button>
	</nui-button-container>
</section>

<section>
	<h2>Singleton Per Placement</h2>
	<p>Factory-created banners are <strong>singleton per placement</strong>. Creating a new banner at the same position automatically closes and replaces the existing one. This prevents banner stacking and ensures only one notification per edge.</p>
	<nui-code>
		<pre><code data-lang="javascript">// First banner at top
nui.components.banner.show({ content: 'Message 1', placement: 'top' });

// This replaces the first banner (same placement)
nui.components.banner.show({ content: 'Message 2', placement: 'top' });

// This is separate (different placement)
nui.components.banner.show({ content: 'Message 3', placement: 'bottom' });</code></pre>
	</nui-code>
	<h3>Try It</h3>
	<nui-button-container gap="1rem">
		<nui-button><button type="button" data-action="show-replacement-demo">Click Multiple Times</button></nui-button>
	</nui-button-container>
</section>

<section>
	<h2>Complex HTML Example: Cookie Consent</h2>
	<p>Banners can contain rich HTML including styled elements and interactive controls. Use <code>showCloseButton: false</code> when providing custom actions.</p>
	<nui-code>
		<pre><code data-lang="javascript">nui.components.banner.show({
    content: `
        &lt;div style="display: flex; flex-direction: column; gap: 1rem;"&gt;
            &lt;div&gt;
                &lt;strong&gt;üç™ Cookie Preferences&lt;/strong&gt;
                &lt;p style="margin: 0.5rem 0 0 0; opacity: 0.8;"&gt;
                    We use cookies to enhance your experience.
                &lt;/p&gt;
            &lt;/div&gt;
            &lt;div style="display: flex; gap: 0.5rem; flex-wrap: wrap;"&gt;
                &lt;button onclick="handleCookies('all')"&gt;Accept All&lt;/button&gt;
                &lt;button onclick="handleCookies('essential')"&gt;Essential Only&lt;/button&gt;
                &lt;button onclick="handleCookies('settings')"&gt;Customize&lt;/button&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    `,
    placement: 'bottom',
    showCloseButton: false,
    autoClose: 0
});</code></pre>
	</nui-code>
	<h3>Try It</h3>
	<nui-button-container gap="1rem">
		<nui-button><button type="button" data-action="show-cookie-consent">Show Cookie Consent</button></nui-button>
	</nui-button-container>
</section>

<section>
	<h2>Auto-Close Progress Indicator</h2>
	<p>Banners with <code>autoClose</code> display a progress bar showing remaining time. The bar appears at the opposite edge of the banner placement (bottom for top banners, top for bottom banners). Disable with <code>showProgress: false</code>.</p>
	<nui-code>
		<pre><code data-lang="javascript">// With progress indicator (default when autoClose is set)
nui.components.banner.show({
    content: 'This will close in 5 seconds...',
    autoClose: 5000
});

// Without progress indicator
nui.components.banner.show({
    content: 'Silent countdown...',
    autoClose: 5000,
    showProgress: false
});</code></pre>
	</nui-code>
	<h3>Try It</h3>
	<nui-button-container gap="1rem">
		<nui-button><button type="button" data-action="show-progress-demo">With Progress</button></nui-button>
		<nui-button><button type="button" data-action="show-no-progress-demo">Without Progress</button></nui-button>
	</nui-button-container>
</section>

<section>
	<h2>Attributes Reference</h2>
	<nui-table>
		<table>
			<thead>
				<tr>
					<th>Attribute</th>
					<th>Values</th>
					<th>Description</th>
				</tr>
			</thead>
			<tbody>
				<tr>
					<td><code>placement</code></td>
					<td><code>top</code>, <code>bottom</code></td>
					<td>Edge placement (default: bottom)</td>
				</tr>
				<tr>
					<td><code>auto-close</code></td>
					<td>milliseconds</td>
					<td>Auto-close timeout (0 = disabled)</td>
				</tr>
				<tr>
					<td><code>priority</code></td>
					<td><code>info</code>, <code>alert</code></td>
					<td>Accessibility priority (default: info)</td>
				</tr>
				<tr>
					<td><code>open</code></td>
					<td>(boolean)</td>
					<td>Present when banner is visible</td>
				</tr>
			</tbody>
		</table>
	</nui-table>
</section>

<section>
	<h2>Factory Options Reference</h2>
	<nui-code>
		<pre><code data-lang="javascript">nui.components.banner.show({
    content: string | Element,   // Banner content (required) - HTML strings are parsed
    placement: 'top' | 'bottom', // Edge placement (default: 'bottom')
    autoClose: number,           // Auto-close ms (default: 0, no auto-close)
    priority: 'info' | 'alert',  // Accessibility priority (default: 'info')
    target: Element,             // Container element (default: auto-detect)
    showCloseButton: boolean,    // Show √ó close button (default: true)
    showProgress: boolean        // Show auto-close progress bar (default: true)
});</code></pre>
	</nui-code>
	<p><strong>Content scaling:</strong> Content has a max-height of 50vh and scrolls if it exceeds this. Set <code>showCloseButton: false</code> when your content includes its own close controls.</p>
</section>

<section>
	<h2>App Mode Behavior</h2>
	<p>In app mode (with <code>&lt;nui-app&gt;</code>), banners automatically appear within the content area rather than the full viewport. A dedicated banner layer prevents banners from affecting the content scrollbar.</p>
	<nui-code>
		<pre><code data-lang="javascript">// In app mode, banners auto-target the content area
nui.components.banner.show({ content: 'Appears in content area' });

// Override with explicit target
nui.components.banner.show({
    content: 'Appears in specific container',
    target: document.querySelector('.my-container')
});</code></pre>
	</nui-code>
</section>

<script type="nui/page">
function init(element, params) {
	let replacementCounter = 0;

	// Handle all banner actions via delegation
	element.addEventListener('nui-action', (e) => {
		const { name, target, param } = e.detail;

		switch(name) {
			// Declarative Banner Actions
			case 'banner-show':
				if (target && target.show) target.show();
				break;
			case 'banner-close':
				if (target && target.close) target.close(param);
				break;

			// Programmatic Demos
			case 'show-top-banner':
				nui.components.banner.show({
					content: 'This banner appears at the top of the content area.',
					placement: 'top',
					autoClose: 3000
				});
				break;
			case 'show-bottom-banner':
				nui.components.banner.show({
					content: 'This banner appears at the bottom of the content area.',
					placement: 'bottom',
					autoClose: 3000
				});
				break;
			case 'show-persistent-banner':
				nui.components.banner.show({
					content: 'This banner stays until you dismiss it.',
					placement: 'top',
					autoClose: 0
				});
				break;
			case 'show-info-banner':
				nui.components.banner.show({
					content: '‚ÑπÔ∏è This is an info banner (role="status").',
					placement: 'bottom',
					priority: 'info',
					autoClose: 3000
				});
				break;
			case 'show-alert-banner':
				nui.components.banner.show({
					content: '‚ö†Ô∏è This is an alert banner (role="alert") - screen readers announce immediately.',
					placement: 'bottom',
					priority: 'alert',
					autoClose: 4000
				});
				break;
			case 'show-replacement-demo':
				replacementCounter++;
				nui.components.banner.show({
					content: `Banner #${replacementCounter} - Click again to replace this banner.`,
					placement: 'top',
					autoClose: 5000
				});
				break;
			case 'show-cookie-consent':
				const cookieBanner = nui.components.banner.show({
					content: `
						<div style="display: flex; flex-direction: column; gap: 1rem;">
							<div>
								<strong style="font-size: 1.1rem;">üç™ Cookie Preferences</strong>
								<p style="margin: 0.5rem 0 0 0; opacity: 0.8;">
									We use cookies to enhance your browsing experience.
								</p>
							</div>
							<div style="display: flex; gap: 0.5rem; flex-wrap: wrap;">
								<nui-button><button type="button" data-action="handle-cookies:all">Accept All</button></nui-button>
								<nui-button><button type="button" data-action="handle-cookies:essential">Essential Only</button></nui-button>
								<nui-button><button type="button" data-action="handle-cookies:customize">Customize</button></nui-button>
							</div>
						</div>
					`,
					placement: 'bottom',
					showCloseButton: false,
					autoClose: 0
				});

				// Forward actions from the banner to the page element
				// (Since the banner is outside the page DOM, events won't bubble to 'element' automatically)
				cookieBanner.element.addEventListener('nui-action', (e) => {
					element.dispatchEvent(new CustomEvent('nui-action', {
						detail: e.detail
					}));
				});
				break;
			case 'handle-cookies':
				nui.components.banner.show({
					content: `Cookie preference saved: <strong>${param}</strong>`,
					placement: 'bottom',
					autoClose: 2000
				});
				break;
			case 'show-progress-demo':
				nui.components.banner.show({
					content: 'This banner will close in 5 seconds. Watch the progress bar!',
					placement: 'top',
					autoClose: 5000
				});
				break;
			case 'show-no-progress-demo':
				nui.components.banner.show({
					content: 'This banner will close in 5 seconds (no progress bar).',
					placement: 'top',
					autoClose: 5000,
					showProgress: false
				});
				break;
		}
	});
}
</script>
