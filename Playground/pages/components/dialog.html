<header>
	<h1>Dialog Component</h1>
	<p>Modal and non-modal dialogs for user interactions requiring a response</p>
</header>

<section>
	<h2>Overview</h2>
	<p>The <code>&lt;nui-dialog&gt;</code> component wraps the native HTML <code>&lt;dialog&gt;</code> element with animations, placement options, and accessibility enhancements. Use dialogs when you need user input or confirmationâ€”for passive notifications, use banners instead.</p>
	<p><strong>Key features:</strong></p>
	<ul>
		<li>Native dialog element with backdrop</li>
		<li>Placement options (top, center, bottom)</li>
		<li>Scale animations for open/close</li>
		<li>System dialogs (alert, confirm, prompt)</li>
		<li>Click-outside-to-close behavior</li>
		<li>Escape key handling</li>
	</ul>
</section>

<section>
	<h2>System Dialogs</h2>
	<p>Use the built-in factory methods for common dialog patterns. These return Promises and handle all the UI automatically.</p>
	<nui-code>
		<script type="example" data-lang="javascript">
// Alert - simple message with OK button
await nui.components.dialog.alert('Title', 'Message text');

// Confirm - returns true/false
const confirmed = await nui.components.dialog.confirm('Delete?', 'This cannot be undone.');
if (confirmed) { /* user clicked OK */ }

// Prompt - returns object with field values, or null if cancelled
const result = await nui.components.dialog.prompt('Enter Details', 'Please fill in the form.', {
	fields: [
		{ id: 'name', label: 'Name', value: 'Default' },
		{ id: 'email', label: 'Email', type: 'email' }
	]
});
if (result) {
	console.log(result.name, result.email);
}
		</script>
	</nui-code>
	<h3>Try It</h3>
	<nui-button-container gap="1rem">
		<nui-button><button type="button" data-action="show-alert">Alert</button></nui-button>
		<nui-button><button type="button" data-action="show-confirm">Confirm</button></nui-button>
		<nui-button><button type="button" data-action="show-prompt">Prompt</button></nui-button>
	</nui-button-container>
	<div class="demo-result">
		<pre id="dialog-result">Result: -</pre>
	</div>
</section>

<section>
	<h2>Declarative Actions</h2>
	<p>For simple cases, you can use <code>data-action</code> to trigger dialogs without writing JavaScript handlers:</p>
	<nui-code>
		<script type="example" data-lang="html">
<!-- Open a dialog -->
<button data-action="dialog-open@#my-dialog">Open Dialog</button>

<!-- Close a dialog -->
<button data-action="dialog-close@#my-dialog">Close Dialog</button>

<!-- Close with return value -->
<button data-action="dialog-close:confirmed@#my-dialog">Confirm</button>
		</script>
	</nui-code>
	<h3>Try It</h3>
	<nui-button-container gap="1rem">
		<nui-button><button type="button" data-action="show-alert">Show Alert</button></nui-button>
	</nui-button-container>
</section>

<section>
	<h2>System Dialog Options</h2>
	<p>All system dialogs accept an options object as the last parameter:</p>
	<nui-code>
		<script type="example" data-lang="javascript">
// Alert with placement
await nui.components.dialog.alert('Notice', 'Positioned at top.', {
	placement: 'top'
});

// Confirm with placement
const ok = await nui.components.dialog.confirm('Delete?', 'Are you sure?', {
	placement: 'bottom'
});

// Prompt with custom target container
await nui.components.dialog.prompt('Login', fields, {
	target: document.querySelector('.my-container'),
	placement: 'center'
});
		</script>
	</nui-code>
	<h3>Try It</h3>
	<nui-button-container gap="1rem">
		<nui-button><button type="button" data-action="show-alert-top">Alert (Top)</button></nui-button>
		<nui-button><button type="button" data-action="show-alert-bottom">Alert (Bottom)</button></nui-button>
	</nui-button-container>
</section>

<section>
	<h2>Blocking Dialogs</h2>
	<p>Add the <code>blocking</code> attribute or option to create dialogs that can only be closed via buttons. Escape key and backdrop clicks are disabled.</p>
	<nui-code>
		<script type="example" data-lang="javascript">
// Blocking system dialog - must click OK
await nui.components.dialog.alert('Important!', 'You must acknowledge this.', {
	blocking: true
});

// Blocking confirm - must choose an option
const confirmed = await nui.components.dialog.confirm('Terms', 'Accept the terms?', {
	blocking: true
});
		</script>
	</nui-code>
	<nui-code>
		<script type="example" data-lang="html">
<!-- Blocking inline dialog -->
<nui-dialog id="blocking-dialog" blocking>
	<dialog>...</dialog>
</nui-dialog>
		</script>
	</nui-code>
	<h3>Try It</h3>
	<nui-button-container gap="1rem">
		<nui-button><button type="button" data-action="show-blocking-alert">Blocking Alert</button></nui-button>
		<nui-button><button type="button" data-action="show-blocking-confirm">Blocking Confirm</button></nui-button>
	</nui-button-container>
</section>

<section>
	<h2>Inline Dialogs</h2>
	<p>Define dialogs in HTML for complex layouts, then control them with standard JavaScript.</p>
	<nui-code>
		<script type="example" data-lang="html">
<!-- Trigger -->
<button id="open-btn">Open Dialog</button>

<!-- Dialog Definition -->
<nui-dialog id="my-dialog">
	<dialog>
		<div class="nui-dialog-alert">
			<div class="nui-headline">Confirm Action</div>
			<div class="nui-copy">Proceed with action?</div>
			<nui-button-container align="end">
				<nui-button type="outline"><button type="button" id="cancel-btn">Cancel</button></nui-button>
				<nui-button type="primary"><button type="button" id="ok-btn">OK</button></nui-button>
			</nui-button-container>
		</div>
	</dialog>
</nui-dialog>
		</script>
	</nui-code>
	<nui-code>
		<script type="example" data-lang="javascript">
const dialog = document.getElementById('my-dialog');

// Open
document.getElementById('open-btn').onclick = () => dialog.showModal();

// Close
document.getElementById('cancel-btn').onclick = () => dialog.close();
document.getElementById('ok-btn').onclick = () => {
	console.log('Confirmed');
	dialog.close();
};
		</script>
	</nui-code>
	<h3>Try It</h3>
	<nui-button-container gap="1rem" align="start">
		<nui-button><button type="button" data-action="open-custom-confirm">Open Custom Confirm</button></nui-button>
		<span id="custom-confirm-state">State: closed | Result: -</span>
	</nui-button-container>

	<nui-dialog id="custom-confirm">
		<dialog>
			<div class="nui-dialog-alert">
				<div class="nui-headline">Confirm Action</div>
				<div class="nui-copy">Do you want to proceed with this action?</div>
				<nui-button-container align="end">
					<nui-button type="outline"><button type="button" id="custom-confirm-cancel">Cancel</button></nui-button>
					<nui-button type="primary"><button type="button" id="custom-confirm-ok">OK</button></nui-button>
				</nui-button-container>
			</div>
		</dialog>
	</nui-dialog>

	<h3>Watching Dialog State with Events</h3>
	<p>Dialogs dispatch custom events when they open or close. Listen for these to react to state changes:</p>
	<nui-code>
		<script type="example" data-lang="javascript">
const dialog = document.querySelector('#custom-confirm');
const stateEl = document.querySelector('#custom-confirm-state');
let lastResult = '-';

// Listen for dialog open
dialog.addEventListener('nui-dialog-open', () => {
	stateEl.textContent = 'State: open | Result: ' + lastResult;
});

// Listen for dialog close
dialog.addEventListener('nui-dialog-close', () => {
	stateEl.textContent = 'State: closed | Result: ' + lastResult;
});

// Handle button clicks
document.querySelector('#custom-confirm-ok').addEventListener('click', () => {
	lastResult = 'confirmed';
	dialog.close();
});

document.querySelector('#custom-confirm-cancel').addEventListener('click', () => {
	lastResult = 'cancelled';
	dialog.close();
});
		</script>
	</nui-code>
</section>

<section>
	<h2>JavaScript Control</h2>
	<p>Control dialogs programmatically using element methods:</p>
	<nui-code>
		<script type="example" data-lang="javascript">
const dialog = document.getElementById('my-dialog');

// Open as modal (with backdrop)
dialog.showModal();

// Open as non-modal (no backdrop)
dialog.show();

// Close dialog
dialog.close();
dialog.close('return-value');  // Optional return value

// Check if open
if (dialog.isOpen()) { ... }
		</script>
	</nui-code>
</section>

<section>
	<h2>Placement Modes</h2>
	<p>Use the <code>placement</code> attribute to position dialogs vertically:</p>
	<nui-table>
		<table>
			<thead>
				<tr>
					<th>Placement</th>
					<th>Position</th>
				</tr>
			</thead>
			<tbody>
				<tr>
					<td><code>top</code></td>
					<td>Upper third of viewport</td>
				</tr>
				<tr>
					<td><code>center</code></td>
					<td>Vertically centered (default)</td>
				</tr>
				<tr>
					<td><code>bottom</code></td>
					<td>Lower third of viewport</td>
				</tr>
			</tbody>
		</table>
	</nui-table>
	<nui-code>
		<script type="example" data-lang="html">
<nui-dialog id="top-dialog" placement="top">...</nui-dialog>
<nui-dialog id="center-dialog" placement="center">...</nui-dialog>
<nui-dialog id="bottom-dialog" placement="bottom">...</nui-dialog>
		</script>
	</nui-code>
	<h3>Try It</h3>
	<nui-button-container gap="1rem">
		<nui-button><button type="button" data-action="dialog-open@#dialog-top">Top</button></nui-button>
		<nui-button><button type="button" data-action="dialog-open@#dialog-center">Center</button></nui-button>
		<nui-button><button type="button" data-action="dialog-open@#dialog-bottom">Bottom</button></nui-button>
	</nui-button-container>

	<nui-dialog id="dialog-top" placement="top">
		<dialog>
			<div class="nui-dialog-alert">
				<div class="nui-headline">Top Placement</div>
				<div class="nui-copy">
					<p>This dialog is positioned in the top third of the viewport.</p>
				</div>
				<nui-button-container align="end">
					<nui-button><button type="button" data-action="dialog-close@#dialog-top">Close</button></nui-button>
				</nui-button-container>
			</div>
		</dialog>
	</nui-dialog>

	<nui-dialog id="dialog-center" placement="center">
		<dialog>
			<div class="nui-dialog-alert">
				<div class="nui-headline">Center Placement</div>
				<div class="nui-copy">
					<p>This dialog is vertically centered (browser default).</p>
				</div>
				<nui-button-container align="end">
					<nui-button><button type="button" data-action="dialog-close@#dialog-center">Close</button></nui-button>
				</nui-button-container>
			</div>
		</dialog>
	</nui-dialog>

	<nui-dialog id="dialog-bottom" placement="bottom">
		<dialog>
			<div class="nui-dialog-alert">
				<div class="nui-headline">Bottom Placement</div>
				<div class="nui-copy">
					<p>This dialog is positioned in the bottom third of the viewport.</p>
				</div>
				<nui-button-container align="end">
					<nui-button><button type="button" data-action="dialog-close@#dialog-bottom">Close</button></nui-button>
				</nui-button-container>
			</div>
		</dialog>
	</nui-dialog>
</section>

<section>
	<h2>Events</h2>
	<p>Dialogs dispatch custom events for close and cancel actions:</p>
	<nui-code>
		<script type="example" data-lang="javascript">
const dialog = document.getElementById('my-dialog');

// Fired when dialog closes (any method)
dialog.addEventListener('nui-dialog-close', (e) => {
	console.log('Closed with:', e.detail.returnValue);
});

// Fired when user presses Escape or clicks backdrop
dialog.addEventListener('nui-dialog-cancel', () => {
	console.log('Dialog was cancelled');
});
		</script>
	</nui-code>
</section>

<section>
	<h2>Attributes Reference</h2>
	<nui-table>
		<table>
			<thead>
				<tr>
					<th>Attribute</th>
					<th>Values</th>
					<th>Description</th>
				</tr>
			</thead>
			<tbody>
				<tr>
					<td><code>placement</code></td>
					<td><code>top</code>, <code>center</code>, <code>bottom</code></td>
					<td>Vertical position (default: center)</td>
				</tr>
				<tr>
					<td><code>blocking</code></td>
					<td>(boolean)</td>
					<td>Disable Escape key and backdrop click closing</td>
				</tr>
				<tr>
					<td><code>id</code></td>
					<td>string</td>
					<td>Required for Doer targeting and JS access</td>
				</tr>
			</tbody>
		</table>
	</nui-table>
</section>

<section>
	<h2>Factory Options Reference</h2>
	<nui-code>
		<script type="example" data-lang="javascript">
// Options object (third parameter for all dialog methods)
{
	placement: 'top' | 'center' | 'bottom',  // Vertical position
	target: Element,                          // Container element (default: document.body)
	modal: boolean,                           // Modal mode (default: true)
	blocking: boolean,                        // Disable Escape/backdrop close (default: false)
	classes: string[]                         // Additional CSS classes for dialog
}
		</script>
	</nui-code>
</section>

<section>
	<h2>Prompt Field Options</h2>
	<nui-code>
		<script type="example" data-lang="javascript">
nui.components.dialog.prompt('Title', 'Optional message text.', {
	fields: [
		{
			id: 'fieldId',        // Required - key in returned object
			label: 'Field Label', // Display label
			type: 'text',         // Input type: text, email, password, number, etc.
			value: 'default'      // Pre-filled value
		}
	]
});
		</script>
	</nui-code>
</section>

<section>
	<h2>Programmatic Control</h2>
	<p>Control dialogs using standard JavaScript methods:</p>
	<nui-code>
		<script type="example" data-lang="javascript">
const dialog = document.querySelector('#my-dialog');

// Open
dialog.showModal();  // As modal with backdrop
dialog.show();       // As non-modal

// Close
dialog.close();              // Close normally
dialog.close('return-value'); // Close with a return value
		</script>
	</nui-code>
	<nui-code>
		<script type="example" data-lang="html">
<!-- Declarative actions for simple cases -->
<button data-action="dialog-open@#my-dialog">Open</button>
<button data-action="dialog-close@#my-dialog">Close</button>
		</script>
	</nui-code>
</section>

<script type="nui/page">
function init(element, params) {
	const resultEl = element.querySelector('#dialog-result');

	function showResult(text) {
		resultEl.textContent = 'Result: ' + JSON.stringify(text);
	}

	// Watch the custom-confirm state and display it
	const stateEl = element.querySelector('#custom-confirm-state');
	const customConfirm = element.querySelector('#custom-confirm');
	let lastResult = '-';

	customConfirm.addEventListener('nui-dialog-open', () => {
		stateEl.textContent = 'State: open | Result: ' + lastResult;
	});

	customConfirm.addEventListener('nui-dialog-close', () => {
		stateEl.textContent = 'State: closed | Result: ' + lastResult;
	});

	// Handle custom confirm button clicks
	element.querySelector('#custom-confirm-ok').addEventListener('click', () => {
		lastResult = 'confirmed';
		customConfirm.close();
	});

	element.querySelector('#custom-confirm-cancel').addEventListener('click', () => {
		lastResult = 'cancelled';
		customConfirm.close();
	});

	// Setup action handlers using data-action delegation
	element.addEventListener('nui-action', async (e) => {
		const { name, target, param } = e.detail;

		switch (name) {
			case 'dialog-open':
				if (target && target.showModal) target.showModal();
				break;
			case 'dialog-close':
				if (target && target.close) target.close(param);
				break;
			case 'show-alert':
				await nui.components.dialog.alert('Hello!', 'This is a standard system alert.', {placement: 'top'});
				showResult('Alert closed');
				break;
			case 'show-confirm':
				const confirmRes = await nui.components.dialog.confirm('Confirmation', 'Are you sure you want to proceed?', {placement: 'top'});
				showResult(confirmRes);
				break;
			case 'show-prompt':
				const promptRes = await nui.components.dialog.prompt('Enter Details', 'Please provide your information.', {
					placement: 'top',
					fields: [
						{ id: 'name', label: 'Name', value: 'John Doe' },
						{ id: 'email', label: 'Email', type: 'email' }
					]
				});
				showResult(promptRes);
				break;
			case 'show-alert-top':
				await nui.components.dialog.alert('Top Placement', 'This alert appears at the top.', { placement: 'top' });
				break;
			case 'show-alert-bottom':
				await nui.components.dialog.alert('Bottom Placement', 'This alert appears at the bottom.', { placement: 'bottom' });
				break;
			case 'show-blocking-alert':
				await nui.components.dialog.alert('Important Notice', 'This dialog cannot be closed with Escape or by clicking outside. You must click OK.', { 
					blocking: true,
					placement: 'top'
				});
				showResult('Blocking alert acknowledged');
				break;
			case 'show-blocking-confirm':
				const blockingRes = await nui.components.dialog.confirm('Terms of Service', 'Do you accept the terms of service? You must choose an option.', { 
					blocking: true,
					placement: 'top'
				});
				showResult(blockingRes ? 'Terms accepted' : 'Terms declined');
				break;
			case 'open-custom-confirm':
				customConfirm.showModal();
				break;
		}
	});
}
</script>
